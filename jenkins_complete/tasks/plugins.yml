---
- name: create jenkins update directory
  file:
    path: "{{jenkins_home}}/updates"
    owner: jenkins
    group: jenkins
    mode: 0755
    state: directory
    recurse: yes

- name: set permissions for default.json
  file:
    path: "{{jenkins_home}}/updates/default.json"
    owner: jenkins
    group: jenkins
    mode: 0755

- name: install plugins
  command: >
    java -jar /{{ jenkins_home }}/jenkins-cli.jar -s http://localhost:{{jenkins_port}}/  install-plugin {{ item }}
    creates={{ jenkins_home }}/plugins/{{ item }}.jpi
  with_items: "{{ my_jenkins_plugins }}"

################################## using jenkins_pluin moduel#########################################################

#- name: plugings
#  jenkins_plugin:
#          name: "{{item.key}}"
#          state: "{{ 'enabled' if item.value['enabled'] else 'disabled'}}"
#  when: >
#    'enabled' in item.value
#  with_dict: "{{ my_jenkins_plugins }}"
